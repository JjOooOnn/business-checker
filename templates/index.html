<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>국세청 사업자 상태 일괄 조회</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        .tab-buttons button { padding: 10px 15px; cursor: pointer; border: 1px solid #ccc; background-color: #f0f0f0; }
        .tab-buttons button.active { background-color: #fff; border-bottom: 1px solid #fff; }
        .tab-content { border: 1px solid #ccc; padding: 20px; border-top: none; }
        .error { color: red; font-weight: bold; margin-top: 15px; }
        .info { background-color: #f0f8ff; padding: 15px; border-radius: 5px; margin-bottom: 20px; font-size: 0.9em;}
        #excel-form { display: none; } /* 엑셀 폼은 기본적으로 숨김 */
        textarea { width: 95%; height: 150px; }
        input[type="submit"] { padding: 10px 20px; cursor: pointer; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>국세청 사업자 상태 일괄 조회</h1>

    <div class="tab-buttons">
        <button id="direct-btn" class="active" onclick="showForm('direct')">직접 입력하기</button>
        <button id="excel-btn" onclick="showForm('excel')">엑셀로 업로드하기</button>
    </div>

    <div class="tab-content">
        <div id="direct-form">
            <div class="info">사업자등록번호를 한 줄에 하나씩 입력하세요.</div>
            <form action="/lookup-direct" method="post">
                <textarea name="business_numbers" placeholder="예시)&#10;1234567890&#10;824-87-00993" required></textarea><br>
                <input type="submit" value="조회하기">
            </form>
        </div>

        <div id="excel-form">
            <div class="info">사업자등록번호가 첫 번째 열에 입력된 엑셀(.xlsx) 파일을 업로드하세요.</div>
            <form action="/upload-excel" method="post" enctype="multipart/form-data">
                <input type="file" name="excel_file" accept=".xlsx" required><br>
                <input type="submit" value="조회 및 다운로드">
            </form>
        </div>
    </div>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="error">
          {% for message in messages %}
            {{ message }}
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <script>
        function showForm(formName) {
            document.getElementById('direct-form').style.display = 'none';
            document.getElementById('excel-form').style.display = 'none';
            document.getElementById('direct-btn').classList.remove('active');
            document.getElementById('excel-btn').classList.remove('active');

            if (formName === 'direct') {
                document.getElementById('direct-form').style.display = 'block';
                document.getElementById('direct-btn').classList.add('active');
            } else {
                document.getElementById('excel-form').style.display = 'block';
                document.getElementById('excel-btn').classList.add('active');
            }
        }
    </script>
</body>
</html>